import 'package:ganglong_shop_app/common_import.dart';import 'package:ganglong_shop_app/data_model/cart_data_model.dart';import 'package:ganglong_shop_app/models/index.dart';import 'package:ganglong_shop_app/request/fetch_user_info.dart';import 'package:ganglong_shop_app/sqflite_model/cart_sqflite.dart';import 'package:ganglong_shop_app/sqflite_model/user_sqflite.dart';class UserInfoModel with ChangeNotifier {  bool _isLogon = false;  UserInfo _userInfo;  CartDataModel _cartDataModel;  bool get isLogon => _isLogon;  UserInfo get userInfo => _isLogon ? _userInfo : null;  set cartDataModel(CartDataModel cartDataModel) {    if (cartDataModel != null) {      _cartDataModel = cartDataModel;    }  }  void init(UserInfo userInfo) {    this._userInfo = userInfo;    this._isLogon = true;  }  ///登录成功  Future userLogonSuccess({@required UserInfo userInfo}) async {    this._userInfo = userInfo;    this._isLogon = true;    //更新数据库    await UserSqflite().insertAllDate<UserInfo>([userInfo]);    //更新购物车    _cartDataModel.init(userInfoModel: this);    notifyListeners();  }  ///刷新用户信息  Future reFreshUserInfo() async {    if (_isLogon) {      this._userInfo =          await FetchUserInfo.fetch(userToken: _userInfo.user_token);      //更新数据库      await UserSqflite().insertAllDate<UserInfo>([_userInfo]);      notifyListeners();    }  }  ///退出登录  Future retireLogon() async {    //更新数据库    await UserSqflite().emptyTable();    this._userInfo = null;    this._isLogon = false;    //更新购物车    _cartDataModel.init(userInfoModel: this);    notifyListeners();  }  ///更新用户信息  Future updateUserInfo(UserInfo userInfo) async {    this._userInfo = userInfo;    //更新数据库    await UserSqflite().insertAllDate<UserInfo>([_userInfo]);    notifyListeners();  }}